jQuery(document).ready(function(o){var e=o("#snippet_type"),t=o("#anonymizeip"),a=o("#anonymizeip")[0],n=o("#gtm_id");o("#script_debug_mode");function s(e){e.attr("disabled",!0)}function r(e){e.removeAttr("disabled")}function i(e,t){e.checked=t}o.widget.bridge("gaetooltip",o.ui.tooltip),o(".ga-tooltip").gaetooltip({position:{my:"left bottom-10",at:"right top",collision:"none"}}),o("#advanced:checkbox").on("change",function(){o(this).is(":checked")?(o("#forcesnopperwrap").show(),o("#wpflow_gs_reports_section").show()):(o("#forcesnopperwrap").hide(),o("#wpflow_gs_reports_section").hide())}),o(".btn_upload").on("click",function(e){o(".settings_content").slideDown(),e.preventDefault()}),o(".btn_close").on("click",function(e){o(".settings_content").slideUp(),e.preventDefault()}),o(".popup").on("click",function(e){o(".popup").slideUp(),e.preventDefault()}),"none"!==e.val()&&"gtm"!==e.val()||(i(a,!1),s(t)),("gtm"===e.val()?r:s)(n),e.on("change",function(){var e=o(this).val();"none"===e||"gtm"===e?(i(a,!1),s(t)):r(t),("gtm"===e?r:s)(n)}),o(".btn_upload").on("click",function(e){o(".settings_content").slideDown(),e.preventDefault()}),o(".btn_close").on("click",function(e){o(".settings_content").slideUp(),e.preventDefault()}),o(".popup").on("click",function(e){o(".popup").slideUp(),e.preventDefault()}),sessionStorage.getItem("gaAccessToken")||s(o(".btn_signout_ga")),o('input[name="ga_events_options[permitted_roles][]"][value="administrator"]').css({"pointer-events":"none",opacity:.5}).prop("checked",!0),o(".divs-istracktime:checkbox").on("change",function(){var e=o(this),t=e.is(":checked"),e=e.data("track"),a="#track-elem"+e,e="#eventValue"+e;t?(o(a).show(),o(e).attr("disabled",!0)):(o(a).hide(),o(e).removeAttr("disabled"))}),o("#empty-istracktime:checkbox").on("change",function(){var e="#empty-trackelem",t="#empty-eventValue";o(this).is(":checked")?(o(e).show(),o(t).attr("disabled",!0)):(o(e).hide(),o(t).removeAttr("disabled"))}),o(".divs-istracktime").trigger("change"),jQuery("body").on("click",'a[href="admin.php?page=wp-google-analytics-events-upgrade"]',function(e){e.preventDefault(),window.open("https://wpflow.com/upgrade/?utm_source=wpadmin&utm_medium=banner&utm_campaign=nav","_blank")})});var gaeAjax=function(r){function e(e){e.preventDefault();var n=r(this).attr("id"),s="#"+r(this).data("action");r.ajax({type:"POST",url:wpflow_ajax.ajax_url,data:{post_id:n,action:"wpflow_get_event_json"},success:function(e){r(s).modal();var t=s,a=e.meta;if(void 0!==a)for(var o in a)a.hasOwnProperty(o)&&(r(t+" #"+o).is(":checkbox")?"true"===a[o][0]?r(t+" #"+o).attr("checked",!0):r(t+" #"+o).removeAttr("checked",!1):r(t+" #"+o).val(a[o][0]));r(s+" #event_id").val(n)},error:function(){alert("Error updating event")}})}function a(e){var t=r(this).data("nonce");r.ajax({type:"post",url:wpflow_ajax.ajax_url,data:{viewId:r(this).val(),action:"wpflow_save_view",ajax_nonce:t},success:function(e){window.location.reload()}})}function o(e){e.preventDefault();e=r(this).data("delete-nonce");r.ajax({type:"post",url:wpflow_ajax.ajax_url,data:{viewId:r(this).val(),action:"wpflow_ga_disconnect",ajax_nonce:e},success:function(e){var t=btoa(window.location.protocol+"//"+window.location.host+window.location.pathname+window.location.search),a=btoa(sessionStorage.getItem("gaAccessToken"));sessionStorage.removeItem("gaAccessToken"),sessionStorage.removeItem("gaTokenCreated"),window.location="https://auth.wpflow.com/ga/sign_out/?redirectUrl="+t+"&accessToken="+a}})}function n(e){e.preventDefault();e=r(this);r.ajax({type:"post",url:wpflow_ajax.ajax_url,data:e.serialize(),success:function(e){window.location.reload()}})}r(document).ready(function(t){void 0!==t.fn.modal.noConflict&&t.fn.modal.noConflict(),t(".wpgae-event-form").on("submit",n),t(".ga_main .edit a").on("click",e),t(".ga_main .delete a").on("click",e),t("#ga-save-view").on("click",a),t(".btn_signout_ga").on("click",o),t('.deactivate a[href*="wp-google-analytics-events"], #wpgae-modal-cancel a').on("click",function(e){e.preventDefault(),t("#wpgae-modal-content, #wpgae-modal-background").toggleClass("active"),t("#wpgae-just-deactivate").attr("href",this.href)}),t("#wpgae-feedback-form").on("submit",function(e){e.preventDefault();e=t(this);t.ajax({type:"POST",url:wpflow_ajax.ajax_url,data:e.serialize(),success:function(e){window.location=t("#wpgae-just-deactivate").attr("href")}})})})}(jQuery);!function(){Promise.resolve();var n,s,e,t,a=window.location.search;function o(){var e=window.location.search;const t=new URLSearchParams(e);e=t.get("page");"undefined"!=typeof ga_reports&&void 0!==ga_reports.ga_view_id&&("wp-google-analytics-events"===e?async function(){var e={viewId:ga_reports.ga_view_id,includeEmptyRows:!0,dateRanges:[{startDate:n,endDate:s}],metrics:[{expression:"ga:totalEvents"}],dimensions:[{name:"ga:date"}]},t={viewId:ga_reports.ga_view_id,includeEmptyRows:!0,dateRanges:[{startDate:n,endDate:s}],metrics:[{expression:"ga:totalEvents"}],filtersExpression:"ga:eventAction==Download",dimensions:[{name:"ga:eventLabel"}],orderBys:[{fieldName:"ga:totalEvents",orderType:"VALUE",sortOrder:"DESCENDING"}],pageSize:10},a={viewId:ga_reports.ga_view_id,includeEmptyRows:!0,dateRanges:[{startDate:n,endDate:s}],metrics:[{expression:"ga:totalEvents"}],filtersExpression:"ga:eventAction==Email Link",dimensions:[{name:"ga:eventLabel"}],orderBys:[{fieldName:"ga:totalEvents",orderType:"VALUE",sortOrder:"DESCENDING"}],pageSize:10};reportResponse=await i([e,t,a]),c(0,"Date","date","Events","number",reportResponse.result.reports[0].data.rows,"all-events-chart"),l(0,"Top 10 Downloads","string","Downloads","number",reportResponse.result.reports[1].data.rows,"top10-downloads-chart"),l(0,"Top 10 Email Links","string","Clicks","number",reportResponse.result.reports[2].data.rows,"top10-email-links-chart")}():"wp-google-analytics-events-click"===e?async function(){var e=new Array,t="";ga_reports.clicksCategories&&e.push(ga_reports.clicksCategories);ga_reports.clicksLabels&&e.push(ga_reports.clicksLabels);ga_reports.clicksActions&&e.push(ga_reports.clicksActions);0;var e={viewId:ga_reports.ga_view_id,includeEmptyRows:!0,dateRanges:[{startDate:n,endDate:s}],metrics:[{expression:"ga:totalEvents"}],filtersExpression:e.join(),dimensions:[{name:"ga:date"}]},a=(t=ga_reports.clicksCategories||"ga:eventCategory==-9999999",{viewId:ga_reports.ga_view_id,includeEmptyRows:!0,dateRanges:[{startDate:n,endDate:s}],metrics:[{expression:"ga:totalEvents"}],filtersExpression:t,dimensions:[{name:"ga:eventCategory"}],orderBys:[{fieldName:"ga:totalEvents",orderType:"VALUE",sortOrder:"DESCENDING"}],pageSize:10}),o=(t=ga_reports.clicksLabels||"ga:eventLabel==-9999999",{viewId:ga_reports.ga_view_id,includeEmptyRows:!0,dateRanges:[{startDate:n,endDate:s}],metrics:[{expression:"ga:totalEvents"}],filtersExpression:t,dimensions:[{name:"ga:eventLabel"}],orderBys:[{fieldName:"ga:totalEvents",orderType:"VALUE",sortOrder:"DESCENDING"}],pageSize:10}),t=(t=ga_reports.clicksActions||"ga:eventAction==-9999999",{viewId:ga_reports.ga_view_id,includeEmptyRows:!0,dateRanges:[{startDate:n,endDate:s}],metrics:[{expression:"ga:totalEvents"}],filtersExpression:t,dimensions:[{name:"ga:eventAction"}],orderBys:[{fieldName:"ga:totalEvents",orderType:"VALUE",sortOrder:"DESCENDING"}],pageSize:10});reportResponse=await i([e,a,o,t]),c(0,"Date","date","Events","number",reportResponse.result.reports[0].data.rows,"all-clicks-chart"),l(0,"Top 10 Clicks by Category","string","Clicks","number",reportResponse.result.reports[1].data.rows,"top10-clicks-by-category-chart"),l(0,"Top 10 Clicks by Label","string","Clicks","number",reportResponse.result.reports[2].data.rows,"top10-clicks-by-label-chart"),l(0,"Top 10 Clicks by Action","string","Clicks","number",reportResponse.result.reports[3].data.rows,"top10-clicks-by-action-chart")}():"wp-google-analytics-events-scroll"===e&&async function(){var e=new Array,t="";ga_reports.scrollCategories&&e.push(ga_reports.scrollCategories);ga_reports.scrollLabels&&e.push(ga_reports.scrollLabels);ga_reports.scrollActions&&e.push(ga_reports.scrollActions);0;var e={viewId:ga_reports.ga_view_id,includeEmptyRows:!0,dateRanges:[{startDate:n,endDate:s}],metrics:[{expression:"ga:totalEvents"}],filtersExpression:e.join(),dimensions:[{name:"ga:date"}]},a=(t=ga_reports.scrollCategories||"ga:eventCategory==-9999999",{viewId:ga_reports.ga_view_id,includeEmptyRows:!0,dateRanges:[{startDate:n,endDate:s}],metrics:[{expression:"ga:totalEvents"}],filtersExpression:t,dimensions:[{name:"ga:eventCategory"}],orderBys:[{fieldName:"ga:totalEvents",orderType:"VALUE",sortOrder:"DESCENDING"}],pageSize:10}),o=(t=ga_reports.scrollLabels||"ga:eventLabel==-9999999",{viewId:ga_reports.ga_view_id,includeEmptyRows:!0,dateRanges:[{startDate:n,endDate:s}],metrics:[{expression:"ga:totalEvents"}],filtersExpression:t,dimensions:[{name:"ga:eventLabel"}],orderBys:[{fieldName:"ga:totalEvents",orderType:"VALUE",sortOrder:"DESCENDING"}],pageSize:10}),t=(t=ga_reports.scrollActions||"ga:eventAction==-9999999",{viewId:ga_reports.ga_view_id,includeEmptyRows:!0,dateRanges:[{startDate:n,endDate:s}],metrics:[{expression:"ga:totalEvents"}],filtersExpression:t,dimensions:[{name:"ga:eventAction"}],orderBys:[{fieldName:"ga:totalEvents",orderType:"VALUE",sortOrder:"DESCENDING"}],pageSize:10});reportResponse=await i([e,a,o,t]),c(0,"Date","date","Events","number",reportResponse.result.reports[0].data.rows,"all-scroll-events-chart"),l(0,"Top 10 Scroll Events by Category","string","Events","number",reportResponse.result.reports[1].data.rows,"top10-scroll-by-category-chart"),l(0,"Top 10 Scroll Events by Label","string","Events","number",reportResponse.result.reports[2].data.rows,"top10-scroll-by-label-chart"),l(0,"Top 10 Scroll Events by Action","string","Events","number",reportResponse.result.reports[3].data.rows,"top10-scroll-by-action-chart")}())}function r(){var e=btoa(window.location.protocol+"//"+window.location.host+window.location.pathname+window.location.search);window.location="https://auth.wpflow.com/ga/auth/"+e}"true"===new URLSearchParams(a).get("report")&&(a=window,t=document,(e=a.gapi||(a.gapi={})).analytics={q:[],ready:function(e){this.q.push(e)}},a=t.createElement("script"),t=t.getElementsByTagName("script")[0],a.src="https://apis.google.com/js/platform.js",t.parentNode.insertBefore(a,t),a.onload=function(){e.load("analytics")},google.charts.load("current",{packages:["corechart","line","table"]}),gapi.analytics.ready(function(){gapi.analytics.auth.on("signIn",function(e){}),d().then(e=>{var t=moment().subtract(30,"days").startOf("day").toDate(),a=moment().endOf("day").toDate();n=moment(t).format("YYYY-MM-DD"),s=moment(a).format("YYYY-MM-DD"),jQuery("#daterange").daterangepicker({datepickerOptions:{numberOfMonths:2,minDate:"-12M",maxDate:"+0",altFormat:"yyyy-mm-dd"}}),jQuery("#daterange").daterangepicker("setRange",{start:t,end:a}),jQuery("#daterange").daterangepicker({change:function(e,t){var a=jQuery("#daterange").daterangepicker("getRange");n=moment(a.start).format("YYYY-MM-DD"),s=moment(a.end).format("YYYY-MM-DD"),o()}}),o()})}));const d=async()=>{var e=window.location.search;const t=new URLSearchParams(e);sessionStorage.getItem("gaAccessToken")?(accessToken=sessionStorage.getItem("gaAccessToken"),tokenCreated=sessionStorage.getItem("gaTokenCreated")):t.get("gaToken")?(accessToken=t.get("gaToken"),tokenCreated=1e3*t.get("gaTokenCreated"),sessionStorage.setItem("gaAccessToken",accessToken),sessionStorage.setItem("gaTokenCreated",tokenCreated)):(accessToken=null,tokenCreated=null),accessToken?(timeElapsed=(Date.now()-tokenCreated)/1e3,timeRemaining=3600-timeElapsed,timeRemaining<120?(sessionStorage.removeItem("gaAccessToken"),sessionStorage.removeItem("gaTokenCreated"),r()):"undefined"==typeof ga_reports||void 0===ga_reports.ga_view_id?(await gapi.analytics.auth.authorize({serverAuth:{access_token:accessToken}}),e=new gapi.analytics.ViewSelector({container:"view-selector"}),jQuery(".ga-view-form").toggle(),e.execute(),e.on("change",function(e){jQuery("#ga-save-view").val(e)})):(jQuery(".ga-reports-section").css("display","flex"),await gapi.analytics.auth.authorize({serverAuth:{access_token:accessToken}}))):jQuery(".ga-reports-no-auth").toggle(),jQuery("#ga-auth").on("click",function(e){e.preventDefault(),r()})};function i(e){return gapi.client.request({path:"/v4/reports:batchGet",root:"https://analyticsreporting.googleapis.com/",method:"POST",body:{reportRequests:e}})}function c(e,t,a,o,n,s,r){var i=new google.visualization.DataTable;i.addColumn(a,t),i.addColumn(n,o),null!=s&&0<s.length&&s.forEach(e=>i.addRow([function(e){var t=e.substr(0,4),a=e.substr(4,2)-1,e=e.substr(6,2),o=new Date(t,a,e);return o.getFullYear()==t&&o.getMonth()==a&&o.getDate()==e?o:"invalid date"}(e.dimensions[0]),parseInt(e.metrics[0].values[0])]));new google.charts.Line(document.getElementById(r)).draw(i,google.charts.Line.convertOptions({curveType:"function",legend:{position:"bottom",textStyle:{fontSize:12}}}))}function l(e,t,a,o,n,s,r){var i=new google.visualization.DataTable,a=null!=s&&0<s.length?(i.addColumn(a,t),i.addColumn(n,o),i.setColumnProperty(0,"className","ga-top-chart-text"),s.forEach(e=>i.addRow([e.dimensions[0],parseInt(e.metrics[0].values[0])])),{showRowNumber:!0,width:"100%",height:"100%"}):(i.addColumn("string",t),i.setColumnProperty(0,"className","ga-top-chart-text-empty"),i.addRows([["No events found"]]),{showRowNumber:!1,width:"100%",height:"391px",minWidth:"100px"});new google.visualization.Table(document.getElementById(r)).draw(i,a)}}();
//# sourceMappingURL=admin-scripts.min.js.map
